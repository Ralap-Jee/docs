# AkkanMore HLD 高层次描述

# 项目概述

基于 [Akka](https://akka.io/) 的分布式编程框架，本项目设计了一个系统级异步类脑芯片仿真器，借助 [AkkA Actor](https://doc.akka.io/docs/akka/current/actors.html)
的分布式异步通信行为来仿真模拟异步电路 各个模块之间的握手行为和数据流，在系统级高层次为异步类脑芯片的架构提供先验性的仿真性能分析，并保留丰富的可拓展接口，提供了异步芯片架构仿真系统的开发解决方案。

![](images\system-architecture.png "akkanmore-system-architecture")

## 类脑架构概述

本项目聚焦于大规模异步类脑芯片系统级架构的仿真，该架构是基于数据流（data flow）结构进行计算的，包含多个异步处理单元（PE），这些PE通过片上网络（NoC）进行互连和通信。为了匹配类脑计算的脉冲稀疏特性和事件驱动特性，大多数类脑架构都使用异步电路来设计实现，以充分提高能效、降低功耗。与实现矩阵或卷积运算的PE脉动阵列不同，由于类脑计算传递脉冲的稀疏特性，并没有显著多的数据搬运（data movement），因而类脑架构里的PE总是通过NoC路由器来进行脉冲地址的传递和通信。

**类脑架构的基本组成单元有**：
1. **异步处理单元（PE）**：类脑芯片的基本计算单元。
   1. **脉冲神经元（Neuron）**：类脑芯片的基本计算单元，PE内部包含多个并行计算的神经元。
   2. **权重存储器（Weight SRAM）**：PE内部的权重存储SRAM，存储PE内部神经元的对应每个突触（synapse）的权重。
   3. **脉冲地址表达编码器（AER）**：脉冲地址编码器，将PE内发放脉冲的神经元编码成对应脉冲地址，并根据轴突共享原则（axon sharing rule）索引需要发送至的目标PE。
   4. **脉冲地址解码器（LUT）**：解码器，将PE内接收到的脉冲地址解码成应激活的神经元，与查找表的功能相似。
   5. **网络接口（Network Interface）**：接口桥梁，连接PE与NoC，负责PE的脉冲数据与NoC的flit数据之间的转换。
2. **片上网络路由器（NoC Router）**：类脑芯片的通信路由器，负责网络接口与路由器、路由器与路由器之间的NoC数据包（packet）和数据微片（flit）的传输。
   1. **开关分配器（Switch Allocator）**：输入端口和虚拟通道的仲裁器、以及输出端口的开关分配器，负责实现NoC路由核心功能，包括仲裁、开关分配、路由算法等。
   2. **输入端口（Input Unit）**：路由器的输入端口，负责缓冲接收到的数据。
   3. **输出端口（Output Unit）**：路由器的输出端口，负责缓冲准备发送的数据。

## 异步电路概述

异步电路是一种不依赖全局时钟信号的电路，其工作原理是通过数据的到达时间来控制电路的工作。异步电路的优点是低功耗、低辐射、低时延、高可靠性等。异步电路天然匹配类脑计算的脉冲稀疏特性和事件驱动特性，因而大多数类脑芯片都是采用异步电路来设计的。

在系统级层次观察异步电路的特性，可以发现：

1. **异步电路的数据流（data flow）特性**：异步电路的数据流是通过数据到达时间来控制的，数据到达时间早的数据会先被处理，数据到达时间晚的数据会后被处理。
2. **异步电路的握手（handshake）协议**：异步电路中各个异步控制器是通过握手信号来进行交互的，从而生成本地时钟信号控制本级寄存器/触发器。通过仿真异步电路的握手协议，可以实现对异步电路数据流行为的模拟。
3. **异步电路的数据流与电路状态相关**：异步电路的数据流是与电路状态相关的，数据流的到达时间和电路状态有关，如**数据令牌前向传播（forward pass of tokens）状态**与**空位气泡反向传播（backward pass of bubbles）状态**、**上升沿触发（posedge trigger）状态**与**下降沿触发（negedge trigger）状态**等。不同状态下，数据流的行为（**如通过的延迟时间delay**）不同。

## 系统级芯片仿真器概述

系统级芯片仿真器在系统级提供芯片硬件的仿真模拟结果，对芯片性能代价如PPA进行系统级层次的分析。

系统级芯片仿真器相比电路仿真器（如Modelsim、VCS等），其特点在于：

1. **仿真速度快**：系统级仿真器是基于高层次的模型进行仿真的，相比电路仿真器，其仿真速度更快。
2. **架构灵活度高**：系统级仿真器充分利用高级编程语言的特性，可以方便地对芯片架构建立的模型进行修改，具备远超RTL级的设计灵活性。
3. **仿真精度低**：由于抽象层次较高，系统级建模忽略了很多电路细节，因而仿真的结果精度相比电路仿真要低。

充分利用系统级仿真器对异步类脑芯片的模拟分析，可以在芯片架构设计阶段进行高效率迭代优化，以提高芯片设计质量和效率。

## 阅读文献

开发人员名单可见于 [贡献者](https://github.com/Ralap-Jee/akkanmore/graphs/contributors)

---